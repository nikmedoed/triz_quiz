{% extends 'base.html' %}

{% block top_right %}
<form method="get" action="/reset" class="reset-form">
  <button class="btn btn-secondary" type="submit">Сброс БД</button>
</form>
{% endblock %}

{% block body %}
  <div class="stage">Результаты</div>
  <div class="content">
    <div class="leaderboard">
      <div class="leader-top">
        {% for u in users[:3] %}
        <div class="leader-card">
          <img class="avatar" src="/avatars/{{ u.telegram_id }}.jpg" alt="{{ u.name }}" />
          <div class="leader-info">
            <div class="leader-name">{{ u.name }}</div>
            <div class="leader-score">{{ u.total_score }}</div>
            <div class="leader-times">Откр.: {{ (u.open_answer_ms / u.open_answer_count / 1000)|round(1) if u.open_answer_count else 0 }} с • Выбор: {{ (u.quiz_answer_ms / u.quiz_answer_count / 1000)|round(1) if u.quiz_answer_count else 0 }} с</div>
          </div>
        </div>
        {% endfor %}
      </div>
      <table class="board">
        <thead><tr><th>#</th><th></th><th>Имя</th><th>Баллы</th><th>Откр. ср. (с)</th><th>Выбор ср. (с)</th></tr></thead>
        <tbody>
          {% for u in users[3:] %}
          <tr>
            <td>{{ loop.index + 3 }}</td>
            <td><img class="avatar small" src="/avatars/{{ u.telegram_id }}.jpg" alt="{{ u.name }}" /></td>
            <td class="align-left">{{ u.name }}</td>
            <td class="align-center">{{ u.total_score }}</td>
            <td class="align-center">{{ (u.open_answer_ms / u.open_answer_count / 1000)|round(1) if u.open_answer_count else 0 }}</td>
            <td class="align-center">{{ (u.quiz_answer_ms / u.quiz_answer_count / 1000)|round(1) if u.quiz_answer_count else 0 }}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}
